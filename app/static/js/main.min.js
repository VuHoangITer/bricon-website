window.addEventListener("scroll",(function(){const e=document.querySelector(".floating-buttons");e&&(e.style.display="flex")}));const observerOptions={threshold:.1,rootMargin:"0px 0px -50px 0px"},observer=new IntersectionObserver((function(e){e.forEach((e=>{e.isIntersecting&&e.target.classList.add("animate-on-scroll")}))}),observerOptions);if(document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".product-card, .blog-card").forEach((e=>{observer.observe(e)}))})),document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".alert.alert-dismissible").forEach((e=>{setTimeout((()=>{new bootstrap.Alert(e).close()}),3e3)}))})),document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll('form[action*="search"]').forEach((e=>{e.addEventListener("submit",(function(t){const n=e.querySelector('input[name="q"], input[name="search"]');n&&""===n.value.trim()&&(t.preventDefault(),alert("Vui l√≤ng nh·∫≠p t·ª´ kh√≥a t√¨m ki·∫øm"))}))}))})),"loading"in HTMLImageElement.prototype){document.querySelectorAll("img[data-src]").forEach((e=>{e.src=e.dataset.src}))}else{const e=document.createElement("script");e.src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.3.2/lazysizes.min.js",document.body.appendChild(e)}let resizeTimer;document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll('a[href*="#"]').forEach((e=>{e.addEventListener("click",(function(e){if(this.hasAttribute("data-bs-toggle"))return;const t=this.getAttribute("href");if("#"===t)return;const n=t.includes("#")?t.split("#")[1]:null;if(n){const t=document.getElementById(n);if(t){e.preventDefault();const n=t.offsetTop-120;window.scrollTo({top:n,behavior:"smooth"})}}}))}))})),function(){const e=document.getElementById("scrollToTop");if(!e)return;const t=e.querySelector("circle.progress"),n=t.r.baseVal.value,s=2*Math.PI*n;function i(){const n=window.pageYOffset||document.documentElement.scrollTop,i=document.documentElement.scrollHeight-document.documentElement.clientHeight,o=s-n/i*100/100*s;t.style.strokeDashoffset=o,n>300?e.classList.add("show"):e.classList.remove("show")}t.style.strokeDasharray=s,t.style.strokeDashoffset=s,e.addEventListener("click",(function(){window.scrollTo({top:0,behavior:"smooth"})}));let o=!1;window.addEventListener("scroll",(function(){o||(window.requestAnimationFrame((function(){i(),o=!1})),o=!0)})),i()}(),document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("bannerCarousel");if(!e)return;const t=e.querySelectorAll('.banner-img[loading="lazy"]');if("IntersectionObserver"in window&&t.length>0){const e=new IntersectionObserver(((e,t)=>{e.forEach((e=>{if(e.isIntersecting){const n=e.target,s=n.closest(".carousel-item");s&&s.classList.add("loading"),n.onload=function(){n.classList.add("loaded"),s&&s.classList.remove("loading"),t.unobserve(n)},n.dataset.src?n.src=n.dataset.src:(n.classList.add("loaded"),s&&s.classList.remove("loading"))}}))}),{rootMargin:"100px"});t.forEach((t=>e.observe(t)))}else t.forEach((e=>e.classList.add("loaded")));if(e.addEventListener("slide.bs.carousel",(function(t){const n=e.querySelectorAll(".carousel-item"),s=t.to,i=n[s];if(i){const e=i.querySelector(".banner-img");e&&!e.classList.contains("loaded")&&e.classList.add("loaded")}[s-1<0?n.length-1:s-1,s+1>=n.length?0:s+1].forEach((e=>{const t=n[e];if(t){const e=t.querySelector(".banner-img");e&&!e.classList.contains("loaded")&&e.classList.add("loaded")}}))})),window.innerWidth>=768){let t=!1;e.addEventListener("mouseenter",(function(){t=!0;const n=bootstrap.Carousel.getInstance(e);n&&n.pause()})),e.addEventListener("mouseleave",(function(){if(t){t=!1;const n=bootstrap.Carousel.getInstance(e);n&&n.cycle()}}))}e.addEventListener("touchstart",(function(){const t=bootstrap.Carousel.getInstance(e);t&&t.pause()})),e.addEventListener("touchend",(function(){const t=bootstrap.Carousel.getInstance(e);t&&setTimeout((()=>t.cycle()),3e3)})),e.addEventListener("keydown",(function(t){const n=bootstrap.Carousel.getInstance(e);n&&("ArrowLeft"===t.key?(t.preventDefault(),n.prev()):"ArrowRight"===t.key&&(t.preventDefault(),n.next()))})),window.matchMedia("(prefers-reduced-motion: reduce)").matches&&(e.setAttribute("data-bs-interval","false"),e.querySelectorAll(".carousel-item").forEach((e=>{e.style.transition="none"})));e.querySelectorAll('.carousel-caption .btn[href^="#"]').forEach((e=>{e.addEventListener("click",(function(e){const t=this.getAttribute("href");if(t&&"#"!==t){const n=document.querySelector(t);n&&(e.preventDefault(),n.scrollIntoView({behavior:"smooth",block:"start"}))}}))})),setTimeout((()=>{e.querySelectorAll(".banner-img:not(.loaded)").forEach((e=>{e.classList.add("loaded");const t=e.closest(".carousel-item");t&&t.classList.remove("loading")}))}),3e3),"undefined"!=typeof gtag&&e.addEventListener("slid.bs.carousel",(function(t){const n=e.querySelector(".carousel-item.active"),s=n?.querySelector("h1, h2")?.textContent;gtag("event","banner_view",{event_category:"Banner",event_label:s||`Slide ${t.to+1}`,value:t.to+1})}));const n=e.querySelector(".banner-img");if(n){const e=n.getAttribute("src")||"";if(e.includes("cloudinary.com")||e.includes("imgix.net")){const t=document.createElement("link");t.rel="preconnect",t.href=e.includes("cloudinary")?"https://res.cloudinary.com":"https://assets.imgix.net",t.crossOrigin="anonymous",document.head.appendChild(t)}}})),window.addEventListener("resize",(function(){clearTimeout(resizeTimer),resizeTimer=setTimeout((function(){const e=document.getElementById("bannerCarousel");if(!e)return;e.querySelectorAll("picture").forEach((e=>{const t=e.querySelector("img");t&&(t.src=t.src)}))}),250)})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("page-loader");e&&setTimeout((()=>e.classList.add("hidden")),1e3)})),function(){"use strict";if(!document.querySelector("#featured-projects .project-slider"))return void console.warn("Featured Projects Swiper: Element not found");const e=new Swiper(".project-slider",{loop:!0,speed:700,slidesPerView:1,spaceBetween:0,pagination:{el:".project-pagination",clickable:!0},autoplay:{delay:4500,disableOnInteraction:!1,pauseOnMouseEnter:!0},keyboard:{enabled:!0,onlyInViewport:!0},a11y:{prevSlideMessage:"D·ª± √°n tr∆∞·ªõc",nextSlideMessage:"D·ª± √°n ti·∫øp theo",paginationBulletMessage:"ƒêi t·ªõi d·ª± √°n {{index}}"},effect:"slide",on:{init:function(){console.log("Featured Projects Swiper: Initialized with",this.slides.length,"slides")}}});window.projectSwiper=e,console.log("Featured Projects Swiper: Ready")}();class ChatbotWidget{constructor(){this.isOpen=!1,this.isTyping=!1,this.remainingRequests=20,this.chatButton=document.getElementById("chatbotButton"),this.chatWidget=document.getElementById("chatbotWidget"),this.closeBtn=document.getElementById("chatbotCloseBtn"),this.messagesContainer=document.getElementById("chatbotMessages"),this.userInput=document.getElementById("chatbotInput"),this.sendBtn=document.getElementById("chatbotSendBtn"),this.resetBtn=document.getElementById("chatbotResetBtn"),this.requestCountEl=document.getElementById("requestCount"),this.chatButton&&this.chatWidget?this.init():console.error("Chatbot elements not found")}init(){this.chatButton.addEventListener("click",(()=>this.toggleChat())),this.closeBtn.addEventListener("click",(()=>this.toggleChat())),this.sendBtn.addEventListener("click",(()=>this.sendMessage())),this.resetBtn.addEventListener("click",(()=>this.resetChat())),this.userInput.addEventListener("keypress",(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),this.sendMessage())})),console.log("Chatbot initialized successfully")}toggleChat(){this.isOpen=!this.isOpen,this.chatWidget.classList.toggle("active"),this.isOpen?(document.body.classList.add("chatbot-open"),this.scrollToBottom(),this.isMobile()&&(document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%",document.body.style.top="0")):(document.body.classList.remove("chatbot-open"),this.isMobile()&&(document.body.style.overflow="",document.body.style.position="",document.body.style.width="",document.body.style.top=""))}isMobile(){return window.innerWidth<=768}async sendMessage(){const e=this.userInput.value.trim();if(e&&!this.isTyping)if(e.length>500)alert("Tin nh·∫Øn qu√° d√†i! Vui l√≤ng nh·∫≠p t·ªëi ƒëa 500 k√Ω t·ª±.");else{this.addMessage(e,"user"),this.userInput.value="",this.setInputState(!1),this.showTyping();try{const t=await fetch("/chatbot/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})}),n=await t.json();this.hideTyping(),t.ok?(this.addMessage(n.response,"bot"),void 0!==n.remaining_requests&&(this.remainingRequests=n.remaining_requests,this.updateRequestCount())):this.addMessage(n.error||n.response||"Xin l·ªói, ƒë√£ c√≥ l·ªói x·∫£y ra. Vui l√≤ng th·ª≠ l·∫°i! üòä","bot")}catch(e){console.error("Chatbot error:",e),this.hideTyping(),this.addMessage("Xin l·ªói, kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn server. Vui l√≤ng ki·ªÉm tra k·∫øt n·ªëi m·∫°ng! üîå","bot")}finally{this.setInputState(!0)}}}addMessage(e,t){const n=document.createElement("div");n.className=`chatbot-message ${t}`;const s=document.createElement("div");s.className="chatbot-message-content",s.innerHTML=this.escapeHtml(e).replace(/\n/g,"<br>"),n.appendChild(s),this.messagesContainer.appendChild(n),this.scrollToBottom()}escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}showTyping(){this.isTyping=!0;const e=document.createElement("div");e.className="chatbot-message bot",e.id="chatbotTypingIndicator";const t=document.createElement("div");t.className="chatbot-typing",t.innerHTML="<span></span><span></span><span></span>",e.appendChild(t),this.messagesContainer.appendChild(e),this.scrollToBottom()}hideTyping(){this.isTyping=!1;const e=document.getElementById("chatbotTypingIndicator");e&&e.remove()}setInputState(e){this.userInput.disabled=!e,this.sendBtn.disabled=!e,this.sendBtn.style.opacity=e?"1":"0.5"}scrollToBottom(){setTimeout((()=>{this.messagesContainer.scrollTop=this.messagesContainer.scrollHeight}),100)}async resetChat(){if(confirm("B·∫°n c√≥ ch·∫Øc mu·ªën l√†m m·ªõi h·ªôi tho·∫°i? T·∫•t c·∫£ tin nh·∫Øn s·∫Ω b·ªã x√≥a."))try{if((await fetch("/chatbot/reset",{method:"POST",headers:{"Content-Type":"application/json"}})).ok){this.messagesContainer.querySelectorAll(".chatbot-message").forEach(((e,t)=>{t>0&&e.remove()})),this.remainingRequests=20,this.updateRequestCount(),this.addMessage("ƒê√£ l√†m m·ªõi h·ªôi tho·∫°i! T√¥i c√≥ th·ªÉ gi√∫p g√¨ cho b·∫°n? üòä","bot")}}catch(e){console.error("Reset error:",e),alert("Kh√¥ng th·ªÉ l√†m m·ªõi h·ªôi tho·∫°i. Vui l√≤ng th·ª≠ l·∫°i!")}}updateRequestCount(){this.requestCountEl&&(this.requestCountEl.textContent=`C√≤n ${this.remainingRequests} tin nh·∫Øn`)}}document.addEventListener("DOMContentLoaded",(()=>{document.getElementById("chatbotButton")&&new ChatbotWidget})),function(){"use strict";window.BlogCarousel=window.BlogCarousel||{};const e=window.BlogCarousel;function t(){e.createOnce()}e.state={isCreated:!1,carouselInstance:null},e.config={transitionDuration:400,snapThreshold:.3},e.createOnce=function(){if(this.state.isCreated)return void console.log("üì± Blog Carousel: Already exists, ensuring visibility");const e=document.querySelector("#featured-blogs-section");if(!e)return void console.log("üì± Blog Carousel: Section not found");const t=e.querySelector(".row.g-4");if(!t)return void console.log("üì± Blog Carousel: Grid not found");const n=t.querySelectorAll(".col-lg-4");if(0===n.length)return void console.log("üì± Blog Carousel: No blog cards found");const s=document.createElement("div");s.className="blog-carousel-wrapper";const i=document.createElement("div");i.className="blog-carousel-container";const o=document.createElement("div");o.className="blog-carousel-track",n.forEach((e=>{const t=document.createElement("div");t.className="blog-carousel-slide",t.innerHTML=e.innerHTML,o.appendChild(t)}));const a=document.createElement("button");a.className="blog-carousel-nav-btn blog-carousel-prev",a.innerHTML='<i class="bi bi-chevron-left"></i>',a.setAttribute("aria-label","Previous");const r=document.createElement("button");r.className="blog-carousel-nav-btn blog-carousel-next",r.innerHTML='<i class="bi bi-chevron-right"></i>',r.setAttribute("aria-label","Next"),i.appendChild(o),s.appendChild(i),s.appendChild(a),s.appendChild(r),t.parentNode.insertBefore(s,t),this.state.carouselInstance=this.setupCarousel(o,i,a,r),this.state.isCreated=!0,console.log(`‚úÖ Blog Carousel: Created with ${n.length} cards (PERMANENT)`)},e.setupCarousel=function(t,n,s,i){const o=t.querySelectorAll(".blog-carousel-slide");let a,r=0,c=1,l=!1,d=0,u=0,h=0,g=0;function m(){const e=window.innerWidth;e<768?c=1:e<=991&&(c=2)}function p(){return n.offsetWidth/c}function f(n=!0){const s=p(),i=-r*s;t.style.transition=n?`transform ${e.config.transitionDuration}ms cubic-bezier(0.25, 0.46, 0.45, 0.94)`:"none",t.style.transform=`translateX(${i}px)`,u=i,h=i}function v(){const e=o.length-c;r<e?r++:r=0,f()}function b(){r>0?r--:r=o.length-c,f()}function y(e){const t=o.length-c;r=Math.max(0,Math.min(e,t)),f()}function w(e){return e.type.includes("mouse")?e.pageX:e.touches[0].clientX}function E(e){l=!0,d=w(e),g=0,t.style.cursor="grabbing",t.style.transition="none",e.type}function L(e){if(!l)return;const n=w(e);g=n-d,u=h+g,t.style.transform=`translateX(${u}px)`,Math.abs(g)>10&&e.preventDefault()}function C(){if(!l)return;l=!1,t.style.cursor="grab";const n=p(),s=g;Math.abs(s)/n>e.config.snapThreshold||Math.abs(s)>50?s<0?v():b():f()}return t.addEventListener("mousedown",E),t.addEventListener("mousemove",L),t.addEventListener("mouseup",C),t.addEventListener("mouseleave",C),t.addEventListener("touchstart",E,{passive:!0}),t.addEventListener("touchmove",L,{passive:!1}),t.addEventListener("touchend",C),t.addEventListener("click",(function(e){if(Math.abs(g)>5)return e.preventDefault(),e.stopPropagation(),!1}),!0),t.addEventListener("mousedown",(function(e){g=0})),t.addEventListener("touchstart",(function(e){g=0})),s.addEventListener("click",(function(e){e.preventDefault(),b()})),i.addEventListener("click",(function(e){e.preventDefault(),v()})),t.style.cursor="grab",t.style.userSelect="none",document.addEventListener("keydown",(function(e){n.closest(".blog-carousel-wrapper")&&("ArrowLeft"===e.key?(e.preventDefault(),b()):"ArrowRight"===e.key&&(e.preventDefault(),v()))})),window.addEventListener("resize",(()=>{clearTimeout(a),a=setTimeout((()=>{m(),y(r)}),250)})),m(),f(),{next:v,prev:b,goToSlide:y,updateItemsPerView:m,updateCarousel:f,getCurrentIndex:()=>r}},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t(),window.addEventListener("pageshow",(function(e){console.log("üì± pageshow:",e.persisted?"from cache":"normal load"),t()})),console.log("üì¶ Blog Carousel: Module loaded (Smooth drag + Infinite loop)")}(),function(){"use strict";window.BannerEffect=window.BannerEffect||{};const e=window.BannerEffect;e.config={carouselId:"bannerCarousel",animationDelay:100,animationTypes:["banner-fade-in","banner-slide-up","banner-slide-left","banner-zoom-in"],defaultAnimation:"banner-fade-in",observerThreshold:.2,enableIntersectionObserver:!0,dragThreshold:50,enableDrag:!0},e.state={carousel:null,captions:[],hasAnimated:!1,isInitialized:!1,currentAnimation:null,bsCarousel:null,isDragging:!1,startX:0,currentX:0,dragStartTime:0},e.init=function(){console.log("üé¨ Banner Effect: Initializing..."),this.state.carousel=document.getElementById(this.config.carouselId),this.state.carousel?("undefined"!=typeof bootstrap&&bootstrap.Carousel&&(this.state.bsCarousel=bootstrap.Carousel.getInstance(this.state.carousel)||new bootstrap.Carousel(this.state.carousel,{ride:"carousel",interval:5e3,pause:"hover"})),this.state.captions=Array.from(this.state.carousel.querySelectorAll(".carousel-caption")),0!==this.state.captions.length?(this.setupInitialAnimation(),this.setupCarouselEvents(),this.config.enableIntersectionObserver?this.setupIntersectionObserver():this.animateCaption(this.state.captions[0]),this.config.enableDrag&&this.setupDragEvents(),this.state.isInitialized=!0,console.log("‚úÖ Banner Effect: Initialized successfully (with drag/swipe)")):console.warn("Banner Effect: No captions found")):console.warn("Banner Effect: Carousel not found")},e.setupInitialAnimation=function(){this.state.captions.forEach(((e,t)=>{const n=e.dataset.animation||this.config.defaultAnimation;e.dataset.animationType=n,e.classList.remove(...this.config.animationTypes),e.style.opacity="0",e.style.visibility="hidden"}))},e.animateCaption=function(e){if(!e)return;const t=e.dataset.animationType||this.config.defaultAnimation;e.classList.remove(...this.config.animationTypes),setTimeout((()=>{e.style.visibility="visible",e.classList.add(t),this.state.currentAnimation=t}),this.config.animationDelay)},e.setupCarouselEvents=function(){this.state.carousel.addEventListener("slide.bs.carousel",(e=>{const t=e.to,n=this.state.captions[t];n&&(this.state.captions.forEach((e=>{e.classList.remove(...this.config.animationTypes),e.style.opacity="0",e.style.visibility="hidden"})),this.animateCaption(n))})),this.state.carousel.addEventListener("slid.bs.carousel",(e=>{console.log(`Banner slid to index: ${e.to}`)}))},e.setupIntersectionObserver=function(){if("IntersectionObserver"in window){const e={threshold:this.config.observerThreshold,rootMargin:"0px"},t=new IntersectionObserver((e=>{e.forEach((e=>{if(e.isIntersecting&&!this.state.hasAnimated){const n=this.state.carousel.querySelector(".carousel-item.active"),s=n?n.querySelector(".carousel-caption"):this.state.captions[0];s&&(this.animateCaption(s),this.state.hasAnimated=!0,t.unobserve(e.target))}}))}),e);t.observe(this.state.carousel)}else this.animateCaption(this.state.captions[0]),this.state.hasAnimated=!0},e.setupDragEvents=function(){const e=this.state.carousel;e.style.cursor="grab",e.addEventListener("mousedown",this.handleDragStart.bind(this)),e.addEventListener("mousemove",this.handleDragMove.bind(this)),e.addEventListener("mouseup",this.handleDragEnd.bind(this)),e.addEventListener("mouseleave",this.handleDragEnd.bind(this)),e.addEventListener("touchstart",this.handleDragStart.bind(this),{passive:!0}),e.addEventListener("touchmove",this.handleDragMove.bind(this),{passive:!0}),e.addEventListener("touchend",this.handleDragEnd.bind(this)),e.addEventListener("contextmenu",(e=>{this.state.isDragging&&e.preventDefault()}));e.querySelectorAll("img").forEach((e=>{e.addEventListener("dragstart",(e=>e.preventDefault()))})),console.log("üëÜ Banner Effect: Drag/Swipe enabled")},e.handleDragStart=function(e){e.target.closest("a, button")||(this.state.isDragging=!0,this.state.startX=this.getPositionX(e),this.state.currentX=this.state.startX,this.state.dragStartTime=Date.now(),this.state.carousel.style.cursor="grabbing",this.state.bsCarousel&&this.state.bsCarousel.pause())},e.handleDragMove=function(e){this.state.isDragging&&(this.state.currentX=this.getPositionX(e))},e.handleDragEnd=function(e){if(!this.state.isDragging)return;this.state.isDragging=!1,this.state.carousel.style.cursor="grab";const t=this.state.currentX-this.state.startX,n=Date.now()-this.state.dragStartTime,s=Math.abs(t)/n;(Math.abs(t)>this.config.dragThreshold||s>.5)&&this.state.bsCarousel&&(t>0?this.state.bsCarousel.prev():this.state.bsCarousel.next()),setTimeout((()=>{this.state.bsCarousel&&this.state.bsCarousel.cycle()}),300),this.state.startX=0,this.state.currentX=0,this.state.dragStartTime=0},e.getPositionX=function(e){return e.type.includes("mouse")?e.pageX:e.touches[0].clientX},e.setAnimationType=function(e){this.config.animationTypes.includes(e)?(this.config.defaultAnimation=e,console.log(`Banner Effect: Animation type set to ${e}`)):console.warn(`Banner Effect: Invalid animation type "${e}"`)},e.toggleDrag=function(e){this.config.enableDrag=e,e&&this.state.isInitialized&&this.setupDragEvents(),console.log("Banner Effect: Drag "+(e?"enabled":"disabled"))},e.refresh=function(){if(!this.state.isInitialized)return;console.log("üîÑ Banner Effect: Refreshing..."),this.setupInitialAnimation();const e=this.state.carousel.querySelector(".carousel-item.active .carousel-caption");e&&this.animateCaption(e)},e.destroy=function(){this.state.isInitialized&&(console.log("üóëÔ∏è Banner Effect: Destroying..."),this.state.captions.forEach((e=>{e.classList.remove(...this.config.animationTypes),e.style.opacity="",e.style.visibility=""})),this.state.carousel&&(this.state.carousel.style.cursor=""),this.state={carousel:null,captions:[],hasAnimated:!1,isInitialized:!1,currentAnimation:null,bsCarousel:null,isDragging:!1,startX:0,currentX:0,dragStartTime:0})},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>{e.init()})):e.init(),window.addEventListener("load",(()=>{e.state.isInitialized||e.init()})),window.addEventListener("beforeunload",(()=>{e.destroy()})),console.log("üì¶ Banner Effect: Module loaded (with drag/swipe support)")}(),function(){"use strict";window.Newsletter=window.Newsletter||{};const e=window.Newsletter;e.init=function(){const e=document.getElementById("newsletterForm");e&&(e.addEventListener("submit",this.handleSubmit.bind(this)),console.log("‚úÖ Newsletter: Initialized"))},e.handleSubmit=async function(e){e.preventDefault();const t=e.target,n=t.querySelector("#newsletter-email"),s=t.querySelector("#newsletter-consent"),i=document.getElementById("newsletterMessage"),o=t.querySelector("#newsletter-submit-btn"),a=o.querySelector(".btn-text"),r=o.querySelector(".btn-icon"),c=o.querySelector(".btn-spinner");if(i.className="newsletter-message",i.textContent="",!n.value.trim())return this.showMessage(i,"Vui l√≤ng nh·∫≠p email!","error"),void n.focus();if(s.checked){o.disabled=!0,a.classList.add("d-none"),r.classList.add("d-none"),c.classList.remove("d-none");try{const e=await fetch("/newsletter/subscribe",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({email:n.value.trim(),consent:s.checked})}),o=await e.json();e.ok&&o.success?(this.showMessage(i,o.message,"success"),t.reset(),"undefined"!=typeof gtag&&gtag("event","newsletter_signup",{event_category:"Newsletter",event_label:"Success"})):this.showMessage(i,o.message||"C√≥ l·ªói x·∫£y ra!","error")}catch(e){console.error("Newsletter subscription error:",e),this.showMessage(i,"Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn server. Vui l√≤ng th·ª≠ l·∫°i!","error")}finally{o.disabled=!1,a.classList.remove("d-none"),r.classList.remove("d-none"),c.classList.add("d-none")}}else this.showMessage(i,"Vui l√≤ng ƒë·ªìng √Ω nh·∫≠n email marketing!","error")},e.showMessage=function(e,t,n){e.textContent=t,e.className=`newsletter-message ${n}`,"success"===n&&setTimeout((()=>{e.style.opacity="0",setTimeout((()=>{e.className="newsletter-message",e.textContent="",e.style.opacity="1"}),300)}),5e3)},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>e.init())):e.init()}(),function(){"use strict";const e={contentSelector:".blog-content-detail",tocContainerId:"blog-toc-container",inlineTocContainerId:"blog-inline-toc-content",headingSelectors:"h2, h3, h4",activeClass:"active",scrollOffset:100,observerRootMargin:"-100px 0px -66%",smoothScrollBehavior:"smooth"};function t(e){return parseInt(e.tagName.substring(1))}function n(){const n=document.getElementById(e.tocContainerId),s=document.getElementById(e.inlineTocContainerId),i=document.querySelector(e.contentSelector);if(!i)return;const o=function(n){const s=n.querySelectorAll(e.headingSelectors),i=new Set,o=[];return s.forEach(((e,n)=>{if(e.id)i.add(e.id);else{const t=e.textContent.trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/ƒë/g,"d").replace(/[^a-z0-9\s-]/g,"").trim().replace(/\s+/g,"-").replace(/-+/g,"-").substring(0,50);e.id=function(e,t){let n=e,s=1;for(;t.has(n);)n=`${e}-${s}`,s++;return t.add(n),n}(t,i)}o.push({id:e.id,text:e.textContent.trim(),level:t(e),element:e})})),o}(i);if(0!==o.length){if(n){const t=function(t){if(0===t.length)return'<p class="text-muted small">Kh√¥ng c√≥ m·ª•c l·ª•c</p>';let n='<nav class="blog-toc-nav" aria-label="M·ª•c l·ª•c b√†i vi·∫øt"><ul class="blog-toc-list">';return t.forEach(((t,s)=>{const i=`toc-level-${t.level}`,o=0===s;n+=`\n        <li class="blog-toc-item ${i}">\n          <a href="#${t.id}"\n             class="blog-toc-link ${o?e.activeClass:""}"\n             data-target="${t.id}"\n             title="${t.text}">\n            ${t.text}\n          </a>\n        </li>\n      `})),n+="</ul></nav>",n}(o);n.innerHTML=t}if(s){const e=function(e){if(0===e.length)return"";let t='<ul class="blog-inline-toc-list">';return e.forEach((e=>{const n=`inline-toc-level-${e.level}`;t+=`\n        <li class="blog-inline-toc-item ${n}">\n          <a href="#${e.id}"\n             class="blog-inline-toc-link"\n             data-target="${e.id}"\n             title="${e.text}">\n            ${e.text}\n          </a>\n        </li>\n      `})),t+="</ul>",t}(o);s.innerHTML=e}if(n){const t=function(t){const n=document.querySelectorAll(".blog-toc-link"),s=new Map;n.forEach((e=>{const t=e.getAttribute("data-target");s.set(t,e)}));const i=new IntersectionObserver((t=>{t.forEach((t=>{const i=s.get(t.target.id);t.isIntersecting&&(n.forEach((t=>t.classList.remove(e.activeClass))),i&&(i.classList.add(e.activeClass),i.scrollIntoView({behavior:"smooth",block:"nearest"})))}))}),{rootMargin:e.observerRootMargin,threshold:[0,1]});return t.forEach((e=>{i.observe(e.element)})),i}(o);window.addEventListener("beforeunload",(()=>{t.disconnect()}))}document.addEventListener("click",(t=>{const n=t.target.closest(".blog-toc-link, .blog-inline-toc-link");if(!n)return;t.preventDefault();const s=n.getAttribute("data-target"),i=document.getElementById(s);if(i){const t=e.scrollOffset,n=i.getBoundingClientRect().top+window.pageYOffset-t;window.scrollTo({top:n,behavior:e.smoothScrollBehavior})}}))}else if(n&&(n.style.display="none"),s){const e=document.getElementById("blog-inline-toc-container");e&&(e.style.display="none")}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",n):n()}(),function(){"use strict";const e={holdTimer:null,holdDelay:200,init:function(){this.setupEventListeners()},setupEventListeners:function(){document.querySelectorAll(".nav-item.dropdown").forEach((e=>{const t=e.querySelector(".nav-link.dropdown-toggle"),n=e.querySelector(".dropdown-menu");t&&n&&(e.classList.add("hold-hien-dropdown"),t.addEventListener("mouseenter",(()=>{this.startHoldTimer(e)})),t.addEventListener("mouseleave",(()=>{this.cancelHoldTimer()})),n.addEventListener("mouseenter",(()=>{this.cancelHoldTimer()})),n.addEventListener("mouseleave",(()=>{this.hideDropdown(e)})),t.addEventListener("click",(t=>{t.preventDefault(),this.toggleDropdown(e)})))})),document.addEventListener("click",(e=>{e.target.closest(".nav-item.hold-hien-dropdown")||this.hideAllDropdowns()}))},startHoldTimer:function(e){this.cancelHoldTimer(),this.holdTimer=setTimeout((()=>{this.showDropdown(e)}),this.holdDelay)},cancelHoldTimer:function(){this.holdTimer&&(clearTimeout(this.holdTimer),this.holdTimer=null)},showDropdown:function(e){this.hideAllDropdowns(),e.classList.add("show")},hideDropdown:function(e){e.classList.remove("show")},toggleDropdown:function(e){const t=e.classList.contains("show");this.hideAllDropdowns(),t||e.classList.add("show")},hideAllDropdowns:function(){document.querySelectorAll(".nav-item.hold-hien-dropdown.show").forEach((e=>{e.classList.remove("show")}))}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>{e.init()})):e.init(),window.holdHienDropdown=e}(),document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("productLightbox"),t=document.getElementById("lightboxImage"),n=new bootstrap.Modal(e);document.querySelectorAll(".lightbox-trigger").forEach((e=>{e.addEventListener("click",(function(e){e.preventDefault();const s=this.getAttribute("data-image"),i=this.getAttribute("data-title");t.src=s,t.alt=i,n.show()}))})),e.addEventListener("hidden.bs.modal",(function(){t.src=""}))})),function(){"use strict";class e{constructor(e,t){this.input=document.querySelector(e),this.resultsContainer=document.querySelector(t),this.debounceTimer=null,this.currentFocus=-1,this.cache=new Map,this.input&&this.resultsContainer&&this.init()}init(){this.input.addEventListener("input",(e=>this.handleInput(e))),this.input.addEventListener("keydown",(e=>this.handleKeydown(e))),this.input.addEventListener("focus",(()=>{this.input.value.trim().length>=2&&(this.resultsContainer.style.display="block")})),document.addEventListener("click",(e=>{this.input.contains(e.target)||this.resultsContainer.contains(e.target)||this.hideResults()})),this.input.closest("form")?.addEventListener("submit",(e=>{this.currentFocus>=0&&(e.preventDefault(),this.selectItem(this.currentFocus))}))}handleInput(e){const t=e.target.value.trim();clearTimeout(this.debounceTimer),t.length<2?this.hideResults():this.debounceTimer=setTimeout((()=>{this.fetchSuggestions(t)}),300)}async fetchSuggestions(e){if(this.cache.has(e))this.renderResults(this.cache.get(e));else try{this.showLoading();const t=await fetch(`/api/search-suggestions?q=${encodeURIComponent(e)}`),n=await t.json();if(this.cache.set(e,n.suggestions),this.cache.size>20){const e=this.cache.keys().next().value;this.cache.delete(e)}this.renderResults(n.suggestions)}catch(e){console.error("Search error:",e),this.hideResults()}}showLoading(){this.resultsContainer.innerHTML='\n        <div class="search-autocomplete-loading">\n          <div class="spinner-border spinner-border-sm text-warning" role="status">\n            <span class="visually-hidden">ƒêang t√¨m...</span>\n          </div>\n          <span class="ms-2">ƒêang t√¨m ki·∫øm...</span>\n        </div>\n      ',this.resultsContainer.style.display="block"}renderResults(e){if(!e||0===e.length)return this.resultsContainer.innerHTML='\n          <div class="search-autocomplete-empty">\n            <i class="bi bi-search"></i>\n            <span>Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£ ph√π h·ª£p</span>\n          </div>\n        ',void(this.resultsContainer.style.display="block");const t={page:[],product:[],blog:[]};e.forEach((e=>{t[e.type]&&t[e.type].push(e)}));let n="";t.page.length>0&&(n+='<div class="search-autocomplete-group">',n+='<div class="search-autocomplete-group-title"><i class="bi bi-file-text"></i> Trang th√¥ng tin</div>',t.page.forEach(((e,t)=>{n+=this.renderItem(e,t)})),n+="</div>"),t.product.length>0&&(n+='<div class="search-autocomplete-group">',n+='<div class="search-autocomplete-group-title"><i class="bi bi-box-seam"></i> S·∫£n ph·∫©m</div>',t.product.forEach(((e,s)=>{n+=this.renderItem(e,t.page.length+s)})),n+="</div>"),t.blog.length>0&&(n+='<div class="search-autocomplete-group">',n+='<div class="search-autocomplete-group-title"><i class="bi bi-journal-text"></i> B√†i vi·∫øt</div>',t.blog.forEach(((e,s)=>{n+=this.renderItem(e,t.page.length+t.product.length+s)})),n+="</div>"),this.resultsContainer.innerHTML=n,this.resultsContainer.style.display="block",this.currentFocus=-1}renderItem(e,t){const n=e.image?`<img src="${e.image}" alt="${e.title}" class="search-autocomplete-image">`:"";return`\n        <a href="${e.url}"\n           class="search-autocomplete-item type-${e.type}"\n           data-index="${t}">\n          ${n}\n          <span class="search-autocomplete-title">${this.highlightKeyword(e.title)}</span>\n        </a>\n      `}highlightKeyword(e){const t=this.input.value.trim();if(!t)return e;const n=new RegExp(`(${t})`,"gi");return e.replace(n,"<mark>$1</mark>")}handleKeydown(e){const t=this.resultsContainer.querySelectorAll(".search-autocomplete-item");0!==t.length&&("ArrowDown"===e.key?(e.preventDefault(),this.currentFocus++,this.currentFocus>=t.length&&(this.currentFocus=0),this.setActive(t)):"ArrowUp"===e.key?(e.preventDefault(),this.currentFocus--,this.currentFocus<0&&(this.currentFocus=t.length-1),this.setActive(t)):"Enter"===e.key?this.currentFocus>=0&&(e.preventDefault(),t[this.currentFocus].click()):"Escape"===e.key&&(this.hideResults(),this.input.blur()))}setActive(e){e.forEach(((e,t)=>{t===this.currentFocus?(e.classList.add("active"),e.scrollIntoView({block:"nearest",behavior:"smooth"})):e.classList.remove("active")}))}selectItem(e){const t=this.resultsContainer.querySelectorAll(".search-autocomplete-item");t[e]&&t[e].click()}hideResults(){this.resultsContainer.style.display="none",this.currentFocus=-1}}function t(){new e(".header-search-input","#search-autocomplete-results"),new e('#searchModal input[name="q"]',"#search-autocomplete-results-mobile"),console.log("‚úÖ Search Autocomplete: Initialized")}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t()}();